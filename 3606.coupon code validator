class Solution:
    def validateCoupons(self, code: List[str], businessLine: List[str], isActive: List[bool]) -> List[str]:
        order = ["electronics", "grocery", "pharmacy", "restaurant"]
        def is_valid_code(s: str) -> bool:
            if not s:  
                return False
            for ch in s:
                if not (ch.isalnum() or ch == "_"):
                    return False
            return True
        valid = []
        for i, c in enumerate(code):
            if (
                isActive[i]                                
                and businessLine[i] in order                
                and is_valid_code(c)                      
            ):
                valid.append((businessLine[i], c))
        valid.sort(key=lambda x: (order.index(x[0]), x[1]))
        return [c for _, c in valid]
